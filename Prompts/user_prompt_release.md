# User Prompt - 版本发布任务

> 当任务类型为"版本发布"时，将本内容附加到 User Prompt

---

## 任务类型

**版本发布**（质量评分 / 发布决策 / Tag 创建 / 报告生成）

---

## 版本号规范（来自 rules_release.md）

### 语义化版本格式

`MAJOR.MINOR.PATCH[-标识符]`

| 组成 | 递增条件 |
|------|----------|
| MAJOR | 不兼容的 API 变更、架构重大变更 |
| MINOR | 向后兼容的功能新增 |
| PATCH | 向后兼容的问题修复 |

### 版本递增决策

```
是否有 BREAKING CHANGE？ → 是 → MAJOR++
是否有 feat: 提交？     → 是 → MINOR++
其他情况                → PATCH++
```

### 预发布标识

| 标识 | 含义 |
|------|------|
| alpha | 内部测试版 |
| beta | 公测版 |
| rc | 候选发布版 |

---

## 质量评分体系（来自 rules_release.md）

### 五维度评分（5分制）

| 维度 | 权重 | 评估内容 |
|------|------|----------|
| D1: 文档完整性 | 20% | L1-L3 文档完整性 |
| D2: 追溯关系 | 15% | L1-L5 追溯链完整性 |
| D3: 功能实现 | 30% | L4 功能完整度 |
| D4: 测试验证 | 25% | L5 测试覆盖率 |
| D5: 代码质量 | 10% | 静态分析、规范 |

### 加权总分计算

```
总分 = D1×0.2 + D2×0.15 + D3×0.3 + D4×0.25 + D5×0.1
```

### 发布决策矩阵

| 总分 | 评级 | 发布类型 | 决策 |
|------|------|----------|------|
| ≥4.5 | 优秀 | 正式版 | ✅ 推荐发布 |
| ≥4.0 | 良好 | 正式版 | ✅ 可以发布 |
| ≥3.0 | 及格 | Beta/RC | ⚠️ 有条件发布 |
| <3.0 | 不及格 | - | ❌ 禁止发布 |

---

## Git Tag 规范（来自 rules_tag.md）

### 必需内容

- ✅ 标题行（≤80字符）：`Release v{VERSION}: {简短标题}`
- ✅ 主要变更（2-5行）
- ✅ 关键特性（3-8项）
- ⚠️ Beta/Alpha 需包含限制说明

### 标准格式

```
Release v{VERSION}: {简短标题}

🚀 主要变更
- {变更1}
- {变更2}

📦 关键特性:
- {特性1}
- {特性2}
- {特性3}

🧪 测试状态:
- 单元测试: {覆盖率}%
- 集成测试: {状态}

✅ 状态: {发布状态}
```

### 禁止

- ❌ 仅使用 `Release vX.Y.Z` 作为全部内容
- ❌ 缺少关键特性列表

---

## 发布报告模板

使用 `templates/tpl_release_report.md`

必需包含：
- 质量评分表（D1-D5）
- 加权总分和评级
- 发布建议
- 改进计划

---

## 发布流程检查清单

### 发布前

- [ ] 质量评分已计算
- [ ] 总分达到发布阈值
- [ ] VERSION 文件已更新
- [ ] ReleaseNote 已生成

### 发布执行

- [ ] Tag 内容符合规范
- [ ] Tag 已创建
- [ ] 发布报告已生成

### 发布后

- [ ] 验证 Tag 存在
- [ ] 通知相关方

