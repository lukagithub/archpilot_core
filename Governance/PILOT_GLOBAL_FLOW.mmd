%% ========================================
%% ArchPilot Core ÂÖ®Â±Ä Pilot ÊµÅÁ®ãÂõæ
%% ËßíËâ≤ÔºöÁ≥ªÁªüÊû∂ÊûÑÂ∏à / ËΩØ‰ª∂Êû∂ÊûÑÂ∑•Á®ãÂ∏à
%% ËØ¥ÊòéÔºöÂ±ïÁ§∫Â¶Ç‰Ωï‰ΩøÁî®Êï¥‰∏™Â∑•Á®ãÁöÑÊñáÊ°£ËµÑ‰∫ßÊé®ËøõÈ°πÁõÆËø≠‰ª£
%% ========================================

flowchart TB
    %% ==================== ËßíËâ≤ÂÖ•Âè£ ====================
    subgraph Role["üë§ Á≥ªÁªü/ËΩØ‰ª∂Êû∂ÊûÑÂ∑•Á®ãÂ∏à"]
        direction LR
        R1["üèõÔ∏è Êû∂ÊûÑËÆæËÆ°"] ~~~ R2["üíª ÂºÄÂèëÊåáÂØº"] ~~~ R3["üîç Ë¥®ÈáèÊääÊéß"] ~~~ R4["üöÄ ÁâàÊú¨ÂèëÂ∏É"]
    end

    %% ==================== Pilot Ëø≠‰ª£Âë®ÊúüÔºàÊ†∏ÂøÉÔºâ ====================
    subgraph Phases["üìÖ Pilot Ëø≠‰ª£Âë®Êúü"]
        direction LR

        subgraph P1["Phase1 ÂêØÂä®"]
            direction TB
            P1_S["‚ë† ÁêÜËß£Ê°ÜÊû∂„ÄÄ„ÄÄ"]
            P1_D1[/"üìñ README"/]
            P1_D2[/"üìñ QUICK_START"/]
            P1_M["‚ë° ÈÉ®ÁΩ≤È°πÁõÆ„ÄÄ„ÄÄ"]
            P1_D3[/"üîß deploy_project.sh"/]
            P1_E["‚ë¢ ËßÑÂàíËø≠‰ª£„ÄÄ„ÄÄ"]
            P1_D4[/"üîÑ flow_planning"/]
            P1_S --- P1_D1 & P1_D2
            P1_D1 & P1_D2 --- P1_M
            P1_M --- P1_D3
            P1_D3 --- P1_E
            P1_E --- P1_D4
        end

        subgraph P2["Phase2 ËÆæËÆ°"]
            direction TB
            P2_S["‚ë† L1 ÈúÄÊ±Ç„ÄÄ„ÄÄ„ÄÄ"]
            P2_D1[/"üìè ARCHITECTURE_DEF"/]
            P2_D2[/"üìù requirement_tpl"/]
            P2_M["‚ë° L2 Êû∂ÊûÑ„ÄÄ„ÄÄ„ÄÄ"]
            P2_D3[/"üìù architecture_tpl"/]
            P2_E["‚ë¢ L3 ËÆæËÆ°„ÄÄ„ÄÄ„ÄÄ"]
            P2_D4[/"üìù design_tpl"/]
            P2_D5[/"üìè rules_naming"/]
            P2_S --- P2_D1 & P2_D2
            P2_D1 & P2_D2 --- P2_M
            P2_M --- P2_D3
            P2_D3 --- P2_E
            P2_E --- P2_D4 & P2_D5
        end

        subgraph P3["Phase3 ÂÆûÁé∞"]
            direction TB
            P3_S["‚ë† L4 ‰ª£Á†Å„ÄÄ„ÄÄ„ÄÄ"]
            P3_D1[/"üìè rules_coding"/]
            P3_D2[/"üîÑ flow_implement"/]
            P3_M["‚ë° L5 ÊµãËØï„ÄÄ„ÄÄ„ÄÄ"]
            P3_D3[/"üìù testcase_tpl"/]
            P3_E["‚ë¢ Ë¥®ÈáèÊ£ÄÊü•„ÄÄ„ÄÄ"]
            P3_D4[/"üîß validate_trace"/]
            P3_D5[/"üîß check_naming"/]
            P3_S --- P3_D1 & P3_D2
            P3_D1 & P3_D2 --- P3_M
            P3_M --- P3_D3
            P3_D3 --- P3_E
            P3_E --- P3_D4 & P3_D5
        end

        subgraph P4["Gate4 ÂèëÂ∏É"]
            direction TB
            P4_S["‚ë† ÁâàÊú¨ÂèëÂ∏É„ÄÄ„ÄÄ"]
            P4_D1[/"üìè rules_release"/]
            P4_D2[/"üîÑ flow_release"/]
            P4_M["‚ë° È™åÊî∂Èó≠ÁéØ„ÄÄ„ÄÄ"]
            P4_D3[/"üîß calculate_score"/]
            P4_E["‚ë¢ Ëø≠‰ª£Â§çÁõò„ÄÄ„ÄÄ"]
            P4_D4[/"üìÑ ReleaseNote"/]
            P4_S --- P4_D1 & P4_D2
            P4_D1 & P4_D2 --- P4_M
            P4_M --- P4_D3
            P4_D3 --- P4_E
            P4_E --- P4_D4
        end

        P1 ==> P2 ==> P3 ==> P4
    end

    %% Ëø≠‰ª£Èó≠ÁéØ
    P4 -.->|üîÑ ‰∏ã‰∏ÄËø≠‰ª£| P1

    %% ==================== AI Pilot Âçè‰ΩúÔºàÂ∫ïÈÉ®Ôºâ ====================
    subgraph AI_Pilot["ü§ñ AI Pilot Âçè‰Ωú"]
        direction LR
        AI_IN["Agents/ + Prompts/"] --> AI_PROC["System + User Prompt"] --> AI_OUT["AIÊâßË°å ‚Üí ‰∫∫Â∑•Á°ÆËÆ§"]
    end

    %% ==================== Â±ÇÁ∫ßËøûÊé• ====================
    Role --> Phases
    Phases --> AI_Pilot

    %% ==================== Ê†∑ÂºèÂÆö‰πâ ====================
    classDef roleStyle fill:#e3f2fd,stroke:#1565c0,stroke-width:3px,color:#000
    classDef phaseStyle fill:#c8e6c9,stroke:#2e7d32,stroke-width:2px,color:#000
    classDef aiStyle fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px,color:#000
    classDef docStyle fill:#fff9c4,stroke:#f57f17,stroke-width:1px,color:#000
    classDef stepStyle fill:#ffffff,stroke:#2e7d32,stroke-width:2px,color:#000

    class Role roleStyle
    class Phases,P1,P2,P3,P4 phaseStyle
    class AI_Pilot aiStyle
    class P1_D1,P1_D2,P1_D3,P1_D4,P2_D1,P2_D2,P2_D3,P2_D4,P2_D5,P3_D1,P3_D2,P3_D3,P3_D4,P3_D5,P4_D1,P4_D2,P4_D3,P4_D4 docStyle
    class P1_S,P1_M,P1_E,P2_S,P2_M,P2_E,P3_S,P3_M,P3_E,P4_S,P4_M,P4_E stepStyle

