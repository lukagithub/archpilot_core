%% ArchPilot Core - é¡¹ç›®éƒ¨ç½²æµç¨‹å›¾
%% å±•ç¤ºä» Core æ¡†æ¶éƒ¨ç½²åˆ°å…·ä½“é¡¹ç›®çš„å®Œæ•´æµç¨‹

flowchart TB
    subgraph Core["ğŸ“¦ ArchPilot Coreï¼ˆæºæ¡†æ¶ï¼‰"]
        direction LR
        C_GOV["Governance/<br/>æ²»ç†è§„åˆ™"]
        C_AGENT["Agents/<br/>Agent å®šä¹‰"]
        C_GUIDE["Guides/<br/>AI æŒ‡å—"]
        C_PROMPT["Prompts/<br/>Prompt æ¨¡æ¿"]
        C_SCRIPT["Scripts/<br/>è„šæœ¬æ¨¡æ¿"]
    end

    subgraph Deploy["ğŸš€ ä¸€é”®éƒ¨ç½²è„šæœ¬"]
        direction TB
        D_CMD["./deploy_project.sh my_project /path"]
        D_OPT["é€‰é¡¹: -i åˆå§‹åŒ–Git"]
        D_CMD ~~~ D_OPT
    end

    subgraph Project["ğŸ¯ ç”Ÿæˆçš„é¡¹ç›®ï¼ˆmy_projectï¼‰"]
        direction TB

        P_TOP[" "]

        subgraph ProjectMain[" "]
            direction LR

            subgraph P_CORE["archpilot/ ğŸ“¦ æ ¸å¿ƒæ¡†æ¶å±‚"]
                direction TB
                PC_GOV["Governance/<br/>æ²»ç†è§„åˆ™"]
                PC_AGENT["Agents/<br/>AI Agent"]
                PC_GUIDE["Guides/<br/>AI æŒ‡å—"]
                PC_PROMPT["Prompts/<br/>Prompt æ¨¡æ¿"]
                PC_SCRIPT["Scripts/<br/>è„šæœ¬å·¥å…·"]
            end

            subgraph P_CUSTOM["ğŸ¯ å®šåˆ¶åŒ–å¼€å‘åŒº"]
                direction TB
                PD_L1["L1_Requirements/<br/>éœ€æ±‚å±‚"]
                PD_L2["L2_Architecture/<br/>æ¶æ„å±‚"]
                PD_L3["L3_DetailDesign/<br/>è®¾è®¡å±‚"]
                PD_L4["L4_Implementation/<br/>å®ç°å±‚"]
                PD_L5["L5_Verification/<br/>éªŒè¯å±‚"]
            end
        end

        P_BOT["é¡¹ç›®æ ¹æ–‡ä»¶: README.md / VERSION / .gitignore"]

        P_TOP ~~~ ProjectMain
        ProjectMain ~~~ P_BOT
    end

    subgraph Workflow["ğŸ“‹ åç»­å¼€å‘å·¥ä½œæµï¼ˆæ¶æ„ â†’ å®ç°ï¼‰"]
        direction TB

        subgraph W_ARCH["ğŸ—ï¸ æ¶æ„è®¾è®¡é˜¶æ®µ"]
            direction LR
            W1["1. å®šåˆ¶åŒ–é…ç½®"]
            W2["2. åˆ›å»º L1 éœ€æ±‚"]
            W3["3. L2 æ¶æ„è®¾è®¡"]
            W1 --> W2 --> W3
        end

        subgraph W_IMPL["ğŸ’» å®ç°éªŒè¯é˜¶æ®µ"]
            direction LR
            W4["4. L3 è¯¦ç»†è®¾è®¡"]
            W5["5. L4 ä»£ç å®ç°"]
            W6["6. L5 æµ‹è¯•éªŒè¯"]
            W4 --> W5 --> W6
        end

        W_ARCH --> W_IMPL
    end

    %% éƒ¨ç½²æµç¨‹è¿æ¥
    Core --> Deploy
    Deploy --> Project

    %% Core åˆ° Project çš„æ˜ å°„ï¼ˆä½¿ç”¨è™šçº¿è¡¨ç¤ºå¤åˆ¶å…³ç³»ï¼‰
    C_GOV -.->|å¤åˆ¶| PC_GOV
    C_AGENT -.->|å¤åˆ¶| PC_AGENT
    C_GUIDE -.->|å¤åˆ¶| PC_GUIDE
    C_PROMPT -.->|å¤åˆ¶| PC_PROMPT
    C_SCRIPT -.->|å¤åˆ¶| PC_SCRIPT

    %% archpilot æ¡†æ¶å±‚ä¸ºå¼€å‘åŒºæä¾›è§„åˆ™å’Œæ¨¡æ¿æ”¯æŒ
    P_CORE -.->|æä¾›è§„åˆ™<br/>å’Œæ¨¡æ¿| P_CUSTOM

    %% Project åˆ° Workflowï¼ˆä½¿ç”¨ä¸å¯è§è¿çº¿è¾…åŠ©å¸ƒå±€ï¼‰
    Project --> Workflow

    %% å¸ƒå±€ trickï¼šä½¿ç”¨ä¸å¯è§è¿çº¿è°ƒæ•´å¯¹é½
    P_CUSTOM ~~~ Workflow

    %% æ ·å¼å®šä¹‰ï¼ˆä¼˜åŒ–é…è‰²ï¼‰
    classDef coreStyle fill:#bbdefb,stroke:#1565c0,stroke-width:3px,color:#000
    classDef deployStyle fill:#ffe0b2,stroke:#ef6c00,stroke-width:3px,color:#000
    classDef projectStyle fill:#c8e6c9,stroke:#2e7d32,stroke-width:3px,color:#000
    classDef workflowStyle fill:#e1bee7,stroke:#6a1b9a,stroke-width:3px,color:#000
    classDef archpilotStyle fill:#fff9c4,stroke:#f57f17,stroke-width:2px,color:#000
    classDef customStyle fill:#b2dfdb,stroke:#00695c,stroke-width:2px,color:#000
    classDef archStageStyle fill:#e8eaf6,stroke:#3f51b5,stroke-width:2px,color:#000
    classDef implStageStyle fill:#fce4ec,stroke:#c2185b,stroke-width:2px,color:#000
    classDef invisibleStyle fill:none,stroke:none,color:transparent

    class Core coreStyle
    class Deploy deployStyle
    class Project,ProjectMain projectStyle
    class Workflow workflowStyle
    class P_CORE archpilotStyle
    class P_CUSTOM customStyle
    class W_ARCH archStageStyle
    class W_IMPL implStageStyle
    class P_TOP,P_BOT invisibleStyle
